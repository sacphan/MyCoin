<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Pavo is a mobile app Bootstrap HTML template created to help you present benefits, features and information about mobile apps in order to convince visitors to download them">
    <meta name="author" content="Your name">

    <!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
	<meta property="og:site_name" content="" /> <!-- website name -->
	<meta property="og:site" content="" /> <!-- website link -->
	<meta property="og:title" content=""/> <!-- title shown in the actual shared post -->
	<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
	<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
	<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
	<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

    <!-- Webpage Title -->
    <title>Pavo Mobile App Website Bootstrap HTML Template</title>
    
    <!-- Styles -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/fontawesome-all.css" rel="stylesheet">
    <link href="css/swiper.css" rel="stylesheet">
	<link href="css/magnific-popup.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">
	
	<!-- Favicon  -->
    <link rel="icon" href="images/favicon.png">
</head>
<body data-spy="scroll" data-target=".fixed-top">
    
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top navbar-light">
        <div class="container">
            
            <!-- Text Logo - Use this if you don't have a graphic logo -->
            <!-- <a class="navbar-brand logo-text page-scroll" href="index.html">Pavo</a> -->

            <!-- Image Logo -->
            <a class="navbar-brand logo-image" href="index.html"><img src="images/logo.svg" alt="alternative"></a> 

            <button class="navbar-toggler p-0 border-0" type="button" data-toggle="offcanvas">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="navbar-collapse offcanvas-collapse" id="navbarsExampleDefault">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#header">My Wallet <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#features">Transaction</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#details">Miner</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#pricing">Tạo ví</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Drop</a>
                        <div class="dropdown-menu" aria-labelledby="dropdown01">
                            <a class="dropdown-item page-scroll" href="article.html">Article Details</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item page-scroll" href="terms.html">Terms Conditions</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item page-scroll" href="privacy.html">Privacy Policy</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#download">Download</a>
                    </li>
                </ul>
                <span class="nav-item app-store-icons">
                    <a href="#your-link">
                        <i class="fab fa-apple"></i>
                    </a>
                    <a href="#your-link">
                        <i class="fab fa-android"></i>
                    </a>
                </span>
            </div> <!-- end of navbar-collapse -->
        </div> <!-- end of container -->
    </nav> <!-- end of navbar -->
    <!-- end of navigation -->


    <!-- Header -->
    <header id="header" class="header">
        <div class="container">
            <div class="row">
            <div class="col-lg-12">
    <label for="publickey">Ví của tôi</label>
    <input type="text" class="form-control" id="publickey" aria-describedby="publickey" placeholder="Nhập địa chỉ của ví.">
    <small id="publickey" class="form-text text-muted">Xem thông tin cập nhập về ví của bạn.</small>
          </div>
            
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </header> <!-- end of header -->
    <!-- end of header -->


    <!-- Introduction -->
    <div class="basic-1">
        <div class="container">
            <div class="row">
                <div class="col-lg-12" id="ContentWallet">
                 
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of basic-1 -->
    <!-- end of introduction -->


    <!-- Features -->
    <div id="features" class="cards-1">
        <div class="container">
            <div class="row">
  <div class="form-group col-lg-6">
    <label for="exampleInputprivatekey">Private Key</label>
    <input type="text" class="form-control" id="privatekey" aria-describedby="privatekey" placeholder="Nhập khóa bí mật của bạn">
  </div>
  <div class="form-group col-lg-6">
    <label for="exampleInputCoin">Số coin gửi</label>
    <input type="number" class="form-control" id="coin" aria-describedby="coin" placeholder="Nhập số coin">
  </div>
      </div> <!-- end of col -->
      <div class="row">
  <div class="form-group col-lg-6">
    <label for="exampleInputpublickey">Public Key</label>
    <input type="text" class="form-control" id="publickeyTransaction" aria-describedby="publickey" placeholder="Nhập khóa công khai của bạn">
  </div>
  <div class="form-group col-lg-6">
    <label for="exampleInputPassword1">Public Key người nhận</label>
    <input type="text" class="form-control" id="publicKeyRecipient" placeholder="Khoa công khai của người nhận">
  </div>

 
</div>
             <button type="button" id="createTransaction" class="btn btn-primary">Tạo Transaction</button>
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of cards-1 -->
    <!-- end of features -->


    <!-- Details 1 -->
    <div id="details" class="basic-2">
        <div class="container">
            <div class="row">
              <h2>Các giao dịch gần đây được thực hiện</h2>
            </div> <!-- end of row -->
            <div class="row">
               <table class="table">
  <thead>
    <tr>
      <th scope="col">ID giao dịch</th>
      <th scope="col">Người gửi</th>
      <th scope="col">Người nhận</th>
      <th scope="col">Tổng</th>
    </tr>
  </thead>
  <tbody id="bodyTransaction">
   
  </tbody>
</table>
<button class="btn btn-primary" id="miner">Miner</button>
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of basic-2 -->
    <!-- end of details 1 -->


    <!-- Pricing -->
    <div id="pricing" class="cards-2">
      
        <div class="container">
  <div class="form-group">
    <label for="exampleInputEmail1">Create Wallet</label>
    <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
    <small id="emailHelp" class="form-text text-muted">Private key and publickey are sent your email</small>
  </div>
   <button type="btn" id="createWallet" class="btn btn-primary">Submit</button>
        </div> <!-- end of container -->
    </div> <!-- end of cards-2 -->
    <!-- end of pricing -->


  

    <!-- Footer -->
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h4>Pavo is a mobile application for marketing automation and you can reach the team at <a class="purple" href="mailto:email@domain.com">email@domain.com</a></h4>
                    <div class="social-container">
                        <span class="fa-stack">
                            <a href="#your-link">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-facebook-f fa-stack-1x"></i>
                            </a>
                        </span>
                        <span class="fa-stack">
                            <a href="#your-link">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x"></i>
                            </a>
                        </span>
                        <span class="fa-stack">
                            <a href="#your-link">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-pinterest-p fa-stack-1x"></i>
                            </a>
                        </span>
                        <span class="fa-stack">
                            <a href="#your-link">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-instagram fa-stack-1x"></i>
                            </a>
                        </span>
                        <span class="fa-stack">
                            <a href="#your-link">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-youtube fa-stack-1x"></i>
                            </a>
                        </span>
                    </div> <!-- end of social-container -->
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of footer -->  
    <!-- end of footer -->


    <!-- Copyright -->
    <div class="copyright">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <ul class="list-unstyled li-space-lg p-small">
                        <li><a href="article.html">Article Details</a></li>
                        <li><a href="terms.html">Terms & Conditions</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                    </ul>
                </div> <!-- end of col -->
                <div class="col-lg-6">
                    <p class="p-small statement">Copyright © <a href="#your-link">Your name</a></p>
                </div> <!-- end of col -->
            </div> <!-- enf of row -->
        </div> <!-- end of container -->
    </div> <!-- end of copyright --> 
    <!-- end of copyright -->
    
    	
    <!-- Scripts -->
    <script src="js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
    <script src="js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
    <script src="js/jquery.easing.min.js"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
    <script src="js/swiper.min.js"></script> <!-- Swiper for image and text sliders -->
    <script src="js/jquery.magnific-popup.js"></script> <!-- Magnific Popup for lightboxes -->
    <script src="js/scripts.js"></script> <!-- Custom scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" ></script>




</body>
</html>
<script>

    $('#publickey').keyup(function(e){
    if(e.keyCode == 13)
    {
         $.ajax({
                url: '/address/'+$(this).val(),
                type: 'GET',
               
            }).done(function(result) {
                console.log(result)
                var TransactionHTML = '';
                result.addressData.addressTransactions.map((item,index) =>{
                    TransactionHTML+=`
                       <tr>
      <th scope="row">${(index+1)}</th>
      <td>${item.sender}</td>
      <td>${item.recipient}</td>
      <td>${item.amount}</td>
    </tr>
                    `
                });
                $("#ContentWallet").html(`<div class="card">
  <div class="card-header">
    Thông tin ví
  </div>
  <div class="card-body">
    <h5 class="card-title">Địa chỉ</h5>
    <p class="card-text">${$('#publickey').val()}</p>
    <h5 class="card-title">Số dư: </h5><p>${result.addressData.addressBalance}</p>
    <h5 class="card-title">Lịch sử giao dịch</h5>
    <table class="table">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Sender</th>
      <th scope="col">Recipient</th>
      <th scope="col">Amount</th>
    </tr>
  </thead>
  <tbody>
      ${TransactionHTML}
   
  </tbody>
</table>
  </div>
</div>`);
            });
    }
});
$("#createTransaction").click(function(){
    let privatekey = $("#privatekey").val();
    let publickey = $("#publickeyTransaction").val();
    let coin   = $("#coin").val();
    let publicKeyRecipient = $("#publicKeyRecipient").val();
         $.ajax({
                url: '/transaction/broadcast',
                type: 'POST',
               dataType:'json',
               data: 
               {
                   sender:publickey,
                   recipient: publicKeyRecipient,
                   amount: coin,
                   privKey:privatekey
               },
                success: function(result){  
                    console.log(result)
                   if (result.note==false)
                   {
                       
                      alert("Create Transaction failed")
                   }
                   else
                   {
                       //toastr.success('Transaction success!', 'Transaction')
                        alert("Create Transaction success")
                        {{!-- $("#privatekey").val('');
                        $("#publickeyTransaction").val('');
                        $("#coin").val('');
                        $("#publicKeyRecipient").val(''); --}}
                        
                         $.ajax({
                url: '/pendingTransactions',
                type: 'GET',          
               }).done(function(result){
                   let html='';
                   result.pendingTransactions.map((item)=>{
                       html+=` <tr>
      <th scope="row">${item.transactionId}</th>
      <td>${item.sender}</td>
      <td>${item.recipient}</td>
      <td>${item.amount}</td>
    </tr>`
                   }) 
                   $("#bodyTransaction").html(html);
               });
                   }
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                 alert("Create Transaction failed")
                }       
            })

})
$("#miner").click(function(){
  var key1 = prompt("Nhập private key của bạn:", "");
  var key2 = prompt("Nhập public key của bạn:", "");
   $.ajax({
                url: '/hashKeys',
                type: 'POST',
               data: 
               {
                  "key1": key1,
                  "key2": key2
               }
   }).done(function(response){
  if (response.note === false) {
                            alert("Các khóa bạn nhập chưa đúng");
                        }
                        else {
                            
                                 $.ajax({
                                    url: '/mine',
                                    type: 'GET'           
                                }).done(function(){
                                    $("#bodyTransaction").html('');
                                     {{!-- $.get('/emitMiningSuccess', (data, status) => {//http request via JQuery
                                        console.log(data);
                                    }); --}}
                                    alert("Miner success")
                                });
                        }
   });
});
$("#createWallet").click(function()
{
     $.ajax({
                                    url: '/send-email',
                                    type: 'POST' ,   
                                    data:{email:$("#exampleInputEmail1").val()}       
                                }).done(function(res){                               
                                    alert(res)
                                });
})
</script>
